{"version":3,"file":"updateRootRoomSummary.js","sourceRoot":"","sources":["../../../src/daimon/summary/updateRootRoomSummary.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,oBAAoB,CAAC;AAC5D,OAAO,EAAE,KAAK,EAA0B,MAAM,gCAAgC,CAAC;AAI/E,MAAM,CAAC,MAAM,qBAAqB,GAChC,CAA8B,GAAiC,EAAE,EAAE,CACnE,KAAK,EAAE,EAAE,MAAM,EAAE,OAAO,EAAyC,EAAE,EAAE;IACnE,MAAM,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACjC,GAAG,EAAE,MAAM;KACZ,CAAC,CAAS,CAAC;IAEZ,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC;QACtB,OAAO;IACT,CAAC;IACD,IAAI,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;QAC7B,OAAO;IACT,CAAC;IAED,MAAM,sBAAsB,GAAG,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACnD,GAAG,EAAE,IAAI,CAAC,SAAS;KACpB,CAAC,CAAY,CAAC;IACf,IAAI,WAAW,CAAC,sBAAsB,CAAC,EAAE,CAAC;QACxC,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;QACnD,OAAO;IACT,CAAC;IAED,MAAM,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACnB,KAAK,EAAE;YACL,GAAG,sBAAsB;YACzB,KAAK,EAAE,OAAO;SACY;KAC7B,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["import type { MessageConnectionInstance } from \"@mjt-engine/message/dist/createConnection\";\nimport { isDefined, isUndefined } from \"@mjt-engine/object\";\nimport { Datas, type DataConnectionMap } from \"@mjt-services/data-common-2025\";\nimport type { Content } from \"../../type/Content\";\nimport type { Room } from \"../../type/Room\";\n\nexport const updateRootRoomSummary =\n  <M extends DataConnectionMap>(con: MessageConnectionInstance<M>) =>\n  async ({ roomId, summary }: { roomId: string; summary?: unknown }) => {\n    const room = (await Datas.get(con)({\n      key: roomId,\n    })) as Room;\n\n    if (isUndefined(room)) {\n      return;\n    }\n    if (isDefined(room.parentId)) {\n      return;\n    }\n\n    const currentRootRoomContent = (await Datas.get(con)({\n      key: room.contentId,\n    })) as Content;\n    if (isUndefined(currentRootRoomContent)) {\n      console.log(\"currentRootRoomContent is undefined\");\n      return;\n    }\n\n    await Datas.put(con)({\n      value: {\n        ...currentRootRoomContent,\n        value: summary,\n      } satisfies Partial<Content>,\n    });\n  };\n"]}
{"version":3,"file":"daimonToSystemPrompt.js","sourceRoot":"","sources":["../../src/daimon/daimonToSystemPrompt.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,GAAG,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAC;AACpD,OAAO,EAAE,cAAc,EAAE,MAAM,kBAAkB,CAAC;AAGlD,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAClC,MAAkB,EAClB,OAA+B,EAAE,EACjC,EAAE;IACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,CAAC;IACzB,MAAM,EAAE,IAAI,EAAE,GAAG,KAAK,CAAC;IACvB,MAAM,EACJ,WAAW,EACX,WAAW,EACX,aAAa,EACb,UAAU,GAAG,EAAE,EACf,WAAW,EACX,yBAAyB;IACzB,YAAY;MACb,GAAG,IAAI,CAAC;IAET,OAAO;QACL,GAAG,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QACrE,cAAc,CAAC,WAAW,EAAE,IAAI,CAAC;QACjC,cAAc,CAAC,WAAW,EAAE,IAAI,CAAC;QACjC,kCAAkC;QAClC,cAAc,CAAC,WAAW,EAAE,IAAI,CAAC;QACjC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC;QACnC,cAAc,CAAC,yBAAyB,EAAE,IAAI,CAAC;KAChD;SACE,MAAM,CAAC,SAAS,CAAC;SACjB,IAAI,CAAC,IAAI,CAAC,CAAC;AAChB,CAAC,CAAC","sourcesContent":["import { iff, isDefined } from \"@mjt-engine/object\";\nimport { renderTemplate } from \"./renderTemplate\";\nimport type { BaseDaimon } from \"../type/Daimon\";\n\nexport const daimonToSystemPrompt = (\n  daimon: BaseDaimon,\n  vars: Record<string, string> = {}\n) => {\n  const { chara } = daimon;\n  const { data } = chara;\n  const {\n    description,\n    personality,\n    system_prompt,\n    extensions = {},\n    mes_example,\n    post_history_instructions,\n    // scenario,\n  } = data;\n\n  return [\n    iff(extensions.depth_prompt, (dp) => renderTemplate(dp.prompt, vars)),\n    renderTemplate(description, vars),\n    renderTemplate(personality, vars),\n    // renderTemplate(scenario, vars),\n    renderTemplate(mes_example, vars),\n    renderTemplate(system_prompt, vars),\n    renderTemplate(post_history_instructions, vars),\n  ]\n    .filter(isDefined)\n    .join(\"\\n\");\n};\n"]}